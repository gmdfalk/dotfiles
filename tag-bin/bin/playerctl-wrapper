#!/usr/bin/env bash

usage() {
    cat << EOF
Usage:
    $(basename $0) (play-pause | pause | prev | next | status | mute)

EOF
    exit 0
}
[[ "$#" -lt 1 ]] && usage

# Always execute mute on remote
if [[ "$1" == mute ]]; then
    ssh htpc "pamixer --toggle-mute"
    exit 0
fi

SPOTIFY_FOUND="$(pgrep spotify)"
COMMAND="playerctl $1 --player=spotify"
HOST="$(hostname)"

if [[ "${HOST}" != "htpc" ]] && [[ -z "${SPOTIFY_FOUND}" ]]; then
    ssh htpc "${COMMAND}"
else
    eval $(${COMMAND})
fi
